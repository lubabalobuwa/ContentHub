<section class="page">
  <header class="header">
    <a class="link" routerLink="/">← Back</a>
  </header>

  <ng-container *ngIf="content$ | async as content; else loading">
    <ng-container *ngIf="content; else notFound">
      <div class="card">
        <div class="title-row">
          <div>
            <p class="eyebrow">Article</p>
            <h1>{{ content.title }}</h1>
          </div>
          <span class="status-pill">{{ content.status }}</span>
        </div>

        <ng-container *ngIf="me$ | async as me">
          <div class="actions" *ngIf="auth.isAuthenticated() && me?.id === content.authorId">
            <a class="ghost-link" [routerLink]="['/edit', content.id]">Edit</a>
            <button
              class="btn"
              [disabled]="isPublishing || content.status === 'Published'"
              (click)="publish(content)">
              {{ isPublishing ? 'Publishing…' : 'Publish' }}
            </button>
          </div>
        </ng-container>

        <p class="error" *ngIf="error">{{ error }}</p>

        <article class="body">
          {{ content.body }}
        </article>
      </div>
    </ng-container>
  </ng-container>

  <ng-template #loading>
    <p class="muted">Loading…</p>
  </ng-template>

  <ng-template #notFound>
    <p class="muted">Content not found.</p>
  </ng-template>
</section>
